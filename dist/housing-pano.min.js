!function(t){function e(i){if(o[i])return o[i].exports;var n=o[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){(function(){var t,e;e=void 0,t=void 0,DirectPano.show_pano=function(){var i,n,a;for(n=$("<img id='start-image'/>"),n.css({visibility:"visible",height:Math.min(DirectPano.initial_height,window.innerHeight)+"px",width:Math.min(DirectPano.initial_width,window.innerWidth)+"px","z-index":"1",position:"absolute",left:"0px",top:"0px"}),n.attr("src","./Dataset/panos-house/start.jpg"),$("#"+DirectPano.pano_div_id).append(n),$("#panos-list").remove(),$("#"+DirectPano.pano_div_id).append("<div id='panos-list'></div>"),a=$("#panos-list"),i=0;i<Object.keys(house).length;)house[i][SIDE_PANEL]===!0&&(a.append("<div id='panos-list-entry-"+i+"'>"+house[i][TITLE]+"</div>"),$("#panos-list-entry-"+i).attr("pano_id",parseInt(i)),$("#panos-list-entry-"+i).bind("click touchstart",function(){e.Transition.moving===!1&&e.Transition.start(null,this.getAttribute("pano_id"))})),i++;e=o(1),e.house=house,e.Annotation=new e.annotation,e.Annotation.add_annotations(0),e.scene.children.length=0,e.add_listeners(),e.Hotspot=new e.hotspot,e.Transition=new e.transition,e.Hotspot.add_hotspots(0),t=new e.animation,e.Config.isUserInteracting=!0},DirectPano.remove_pano=function(){t.destroy=!0,t=null,e.remove_listeners(),e.Hotspot.destroy_hotspot(),e.Hotspot=null,e.Transition.destroy_transition(),e.Transition=null,e.Annotation.destroy_annotation(),e.Annotation=null,e.destroy()}}).call(this)},function(t,e,o){(function(){var e,i,n,a,r,s,l,h,p,c,d,u,f,g;f=o(2),a=void 0,r=void 0,n=void 0,i=void 0,g=function(t){var e,o,i,n;switch(i=t.changedTouches,e=i[0],n="",t.type){case"touchstart":n="mousedown";break;case"touchmove":n="mousemove";break;case"touchend":n="mouseup";break;default:return}o=document.createEvent("MouseEvent"),o.initMouseEvent(n,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(o),t.preventDefault()},h=function(t){var e,o,s;t.preventDefault(),f.Config.current_lon=f.Config.lon,f.Config.target_lon=f.Config.lon,f.Config.current_lat=f.Config.lat,f.Config.target_lat=f.Config.lat,f.Config.isUserInteracting=!0,a=t.clientX,r=t.clientY,n=f.Config.lon,i=f.Config.lat,s=new THREE.Vector3,e=$("#"+DirectPano.pano_div_id),s.set(t.clientX/e.outerWidth()*2-1,2*-(t.clientY/e.outerHeight())+1,.5),s.unproject(f.camera),f.raycaster.set(f.camera.position,s.sub(f.camera.position).normalize()),o=f.raycaster.intersectObjects(f.scene.children,!0),o.length>0&&"hotspot"===o[0].object.name&&f.Transition.start(o[0].object.hotspot_id)},p=function(t){var e;f.Config.isUserInteracting===!0&&(e=.3,f.Config.target_lon=(a-t.clientX)*e+n,f.Config.target_lat=(t.clientY-r)*e+i)},c=function(t){f.Config.isUserInteracting=!1,f.Config.stop_time=Date.now(),f.Config.autoplay=!1},d=function(t){var e,o,i;o=t.pageX,i=t.pageY,e=document.elementFromPoint(o,i),"panos-list"!==$("#"+e.id).parent().attr("id")&&(t.wheelDeltaY?f.camera.fov-=.05*t.wheelDeltaY:t.wheelDelta?f.camera.fov-=.05*t.wheelDelta:t.detail&&(f.camera.fov+=1*t.detail),f.camera.fov=Math.max(60,Math.min(90,f.camera.fov)),f.camera.updateProjectionMatrix())},s=function(t){var e,o,i;i=void 0,t||(t=window.event),f.Config.isUserInteracting=!0,o=t.keyCode,37===o?(f.Config.current_lon=f.Config.lon,f.Config.target_lon=f.Config.lon-20):39===o?(f.Config.current_lon=f.Config.lon,f.Config.target_lon=f.Config.lon+20):38===o?f.Transition.moving===!1&&(i=f.Hotspot.front_nearest_hotspot(f.Transition.current_pano),-1!==i&&f.Transition.start(i)):40===o?f.Transition.moving===!1&&(i=f.Hotspot.back_nearest_hotspot(f.Transition.current_pano),-1!==i&&f.Transition.start(i)):27===o&&(e=$("#"+DirectPano.pano_div_id),e.width()===window.innerWidth&&e.height()===window.innerHeight&&f.escape_fullscreen())},l=function(t){f.Config.isUserInteracting=!1,f.Config.stop_time=Date.now(),f.Config.autoplay=!1},e=function(){return $("#"+DirectPano.pano_div_id).on({click:function(t){$("#"+DirectPano.pano_div_id).focus()},mousedown:function(t){h(t)},mousemove:function(t){p(t)},mouseup:function(t){c(t)},mousewheel:function(t){d(t.originalEvent)},DOMMouseScroll:function(t){d(t.originalEvent)},touchstart:function(t){g(t.originalEvent)},touchmove:function(t){g(t.originalEvent)},touchend:function(t){g(t.originalEvent)},keydown:function(t){s(t)},keyup:function(t){l(t)}})},u=function(){$("#"+DirectPano.pano_div_id).off()},f.add_listeners=e,f.remove_listeners=u,t.exports=f}).call(this)},function(t,e,o){(function(){var e,i;e=o(3),i=function(){function t(){var t;this.current_pano=0,this.moving=!1,this.destroy=!1,e.clear_images={},e.blur_images={},e.clear_images[this.current_pano]=[],t=e.house[this.current_pano][PATH],this.blur_pano=new e.Pano(0,!0),this.clear_pano=new e.Pano(0,!1),this.blur_pano.create_pano(t,0),this.clear_pano.create_pano(t,1).done(function(){var t;return t=1e3,$("#start-image").fadeTo(t,0,function(){$("#start-image").remove(),e.Config.isUserInteracting=!1})}),this.preload_images()}return t.prototype.save_clear_images=function(){var t,o;if(t=this.current_pano,!e.clear_images[t])for(e.clear_images[t]=[],o=0;6>o;)!function(){var i,n,a;for(a=new THREE.Texture(e.texture_placeholder),i=o,e.clear_images[t][i]={},n=0;4>n;)!function(){var r,s,l;s=n,r=new Image,r.onload=function(){r.onload=null,a.image=this,a.needsUpdate=!0,e.clear_images[t][i][s]=r},l=e.house[t][PATH],l=l.replace("%s",e.Config.img_name[o]),l=l.replace("%v",n%2),l=l.replace("%h",parseInt(n/2)),r.src=l}(),n++}(),o++},t.prototype.preload_images=function(){var t,o;for(o=0,t=this.current_pano;o<e.house[t][HOTSPOTS].length;)!function(){var i,n;if(n=e.house[t][HOTSPOTS][o][TO_ID],!e.blur_images[n])for(e.blur_images[n]=[],i=0;6>i;)!function(){var t,o,a;for(a=new THREE.Texture(e.texture_placeholder),t=i,e.blur_images[n][t]={},o=0;4>o;)!function(){var r,s,l;l=o,s=new Image,s.onload=function(){s.onload=null,a.image=this,a.needsUpdate=!0,e.blur_images[n][t][l]=s},r=e.house[n][PATH],r=r.replace(/%s/g,"../blur_"+(n+1)+"/"+e.Config.img_name[i]),r=r.replace(/%v/g,l%2),r=r.replace(/%h/g,parseInt(l/2)),s.src=r}(),o++}(),i++}(),o++},t.prototype.preload_panel_images=function(){var t,o,i;for(t=0;t<Object.keys(e.house).length;){if(e.house[t][SIDE_PANEL]===!0&&(i=t,!e.blur_images[i]))for(e.blur_images[i]=[],o=0;6>o;)!function(){var t,n,a;for(a=new THREE.Texture(e.texture_placeholder),t=o,e.blur_images[i][t]={},n=0;4>n;)!function(){var r,s,l;l=n,s=new Image,s.onload=function(){s.onload=null,a.image=this,a.needsUpdate=!0,e.blur_images[i][t][l]=s},r=e.house[i][PATH],r=r.replace(/%s/g,"../blur_"+(i+1)+"/"+e.Config.img_name[o]),r=r.replace(/%v/g,l%2),r=r.replace(/%h/g,parseInt(l/2)),s.src=r}(),n++}(),o++;t++}},t.prototype.start=function(t,o){var i,n,a,r,s,l,h,p,c;for(i=this.current_pano,h=null,a=0,r=0,p=0,n=0,null!==t?(h=e.house[i][HOTSPOTS][t][TO_ID],r=e.house[i][HOTSPOTS][t][ANGLE],a=e.house[i][HOTSPOTS][t][ERROR],n=60):(h=o,a=0),$("div[id^=panos-list-entry-]").removeClass("active"),c=e.house[h][TITLE],s=0;s<Object.keys(e.house).length;){if(e.house[s][TITLE]===c&&e.house[s][SIDE_PANEL]===!0){$("#panos-list-entry-"+s).addClass("active");break}s++}this.moving=!0,this.current_pano=h,this.save_clear_images(),null!==t?p=this.find_rotation_angle(r):(e.Config.lon=e.house[h][START_POSITION],e.Config.lat=0),e.Hotspot.remove_hotspots(),e.Annotation.remove_annotations(),l=this.old_pano_to_blur_pano.bind(this),this.preload_images(),this.load_blur_pano(a,r,n).done(function(){l(a,r,p,n)})},t.prototype.find_rotation_angle=function(t){var o;for(o=t-e.Config.lon;o>180;)o-=360;for(;-180>o;)o+=360;return o>50?o=(o-180)%360:-50>o&&(o=(o+180)%360),o+=e.Config.lon},t.prototype.load_blur_pano=function(t,o,i){var n,a,r,s;if(this.destroy)return $.when().done(function(){}).promise();for(n=[],a=0;24>a;)n[a]=$.Deferred(),a++;for(this.blur_pano.pano_id=this.current_pano,a=0;6>a;){for(r=0;4>r;)s=e.house[this.current_pano][PATH],s=s.replace(/%s/g,"../blur_"+(this.current_pano+1)+"/"+e.Config.img_name[a]),s=s.replace(/%v/g,r%2),s=s.replace(/%h/g,parseInt(r/2)),this.blur_pano.mesh.children[a].children[r].material.map.dispose(),this.blur_pano.mesh.children[a].children[r].material.map=this.blur_pano.get_texture(this.pano_id,s,n[4*a+r],a,r),this.blur_pano.mesh.children[a].children[r].material.opacity=0,r++;a++}return this.blur_pano.mesh.rotation.y=THREE.Math.degToRad(t),this.blur_pano.mesh.position.x=i*Math.cos(THREE.Math.degToRad(o)),this.blur_pano.mesh.position.z=i*Math.sin(THREE.Math.degToRad(o)),$.when.apply($,n).done(function(){}).promise()},t.prototype.load_clear_pano=function(t){var o,i,n,a;if(this.destroy)return $.when().done(function(){}).promise();for(o=[],i=0;24>i;)o[i]=$.Deferred(),i++;for(this.clear_pano.pano_id=this.current_pano,this.clear_pano.mesh.rotation.y=THREE.Math.degToRad(t),i=0;6>i;){for(n=0;4>n;)a=e.house[this.current_pano][PATH],a=a.replace(/%s/g,e.Config.img_name[i]),a=a.replace(/%v/g,n%2),a=a.replace(/%h/g,parseInt(n/2)),this.clear_pano.mesh.children[i].children[n].material.map.dispose(),this.clear_pano.mesh.children[i].children[n].material.map=this.clear_pano.get_texture(this.pano_id,a,o[4*i+n],i,n),this.clear_pano.mesh.children[i].children[n].material.opacity=0,n++;i++}return $.when.apply($,o).done(function(){}).promise()},t.prototype.old_pano_to_blur_pano=function(t,o,i,n){var a,r,s,l,h,p,c;if(!this.destroy){for(c=.1,n&&(c=.4,TweenLite.to(e.Config,c,{lon:i,lat:0,ease:Power0.easeOut})),p=1,s=0,n&&(p=2,s=.3),a=this.blur_pano,r=this.clear_pano,TweenLite.to(a.mesh.position,p,{x:0,z:0,delay:s,ease:Expo.easeOut}),l=0;6>l;){for(h=0;4>h;)TweenLite.to(r.mesh.children[l].children[h].material,p,{opacity:0,delay:s,ease:Expo.easeOut}),TweenLite.to(a.mesh.children[l].children[h].material,p,{opacity:1,delay:s,ease:Expo.easeOut}),h++;l++}TweenLite.to(r.mesh.position,p,{x:-1*n*Math.cos(THREE.Math.degToRad(o)),z:-1*n*Math.sin(THREE.Math.degToRad(o)),delay:s,ease:Expo.easeOut,onComplete:this.check_new_pano_load.bind(this),onCompleteParams:[t]})}},t.prototype.check_new_pano_load=function(t){var e,o,i;if(!this.destroy){for(this.clear_pano.mesh.position.x=0,this.clear_pano.mesh.position.z=0,o=0;6>o;){for(i=0;4>i;)this.clear_pano.mesh.children[o].children[i].material.opacity=0,this.clear_pano.mesh.children[o].children[i].material.map.dispose(),this.blur_pano.mesh.children[o].children[i].material.opacity=1,i++;o++}e=this.blur_pano_to_new_pano.bind(this),this.load_clear_pano(t).done(function(){e(t)})}},t.prototype.blur_pano_to_new_pano=function(t){var e,o,i,n,a;if(!this.destroy){for(e=this.blur_pano,o=this.clear_pano,a=.5,i=0;6>i;){for(n=0;4>n;)TweenLite.to(e.mesh.children[i].children[n].material,a,{opacity:0,ease:Power0.easeOut}),n++;i++}for(i=0;6>i;){for(n=0;4>n;)5===i&&3===n?TweenLite.to(o.mesh.children[i].children[n].material,a,{opacity:1,ease:Power0.easeOut,onComplete:this.complete.bind(this),onCompleteParams:[t]}):TweenLite.to(o.mesh.children[i].children[n].material,a,{opacity:1,ease:Power0.easeOut}),n++;i++}}},t.prototype.alter_moving=function(){return this.moving=!1},t.prototype.complete=function(t){var o,i;this.destroy||(this.clear_pano.mesh.rotation.y=0,e.Config.lon+=t,i=this.current_pano,o=this.alter_moving.bind(this),e.Hotspot.add_hotspots(i).done(function(){e.Annotation.add_annotations(i),o()}))},t.prototype.destroy_transition=function(){var t,e;this.destroy=!0,t=this.blur_pano,e=this.clear_pano,TweenLite.killTweensOf(t),TweenLite.killTweensOf(e),this.blur_pano.destroy_pano(),this.clear_pano.destroy_pano(),this.blur_pano=null,this.clear_pano=null},t}(),e.transition=i,t.exports=e}).call(this)},function(t,e,o){(function(){var e,i,n;n=o(4),i=void 0,e=function(){function t(){this.panoid=void 0,this.length=0,this.destroy=!1}return t.prototype.add_annotation=function(t){var e,o,i;o=t,t="annotation_"+t,i=$("<div></div>",{id:t}),i.prepend("<img class='annotation' height='40px' width='40px' src='../test/images/info.png'></img> <div class='hotspot-title'> <div class='hotspot-text'>"+n.house[this.panoid][ANNOTATIONS][o][TITLE]+"</div> </div> <div class='info-hotspot'>"+n.house[this.panoid][ANNOTATIONS][o][DESC]+"</div>"),$("#"+DirectPano.pano_div_id).append(i),e=$("#"+t),e.bind("click touchstart",function(){"visible"===e.find(".info-hotspot").css("visibility")?(e.find(".info-hotspot").css("visibility","hidden"),e.find(".hotspot-title").css("visibility","hidden"),e.find(".hotspot-title").css("opacity","0"),e.find(".annotation").css("border-radius","100px")):(e.find(".info-hotspot").css("visibility","visible"),e.find(".hotspot-title").css("visibility","visible"),e.find(".hotspot-title").css("opacity","1"),e.find(".hotspot-title").css("border-radius","0px 10px 0px 0px"),e.find(".annotation").css("border-radius","10px 0px 0px 0px"))}),e.hover(function(){e.find(".hotspot-title").css("visibility","visible"),e.find(".hotspot-title").css("opacity","1"),"hidden"===e.find(".info-hotspot").css("visibility")&&(e.find(".hotspot-title").css("border-radius","0px 10px 10px 0px"),e.find(".annotation").css("border-radius","10px 0px 0px 10px"))},function(){"hidden"===e.find(".info-hotspot").css("visibility")&&(e.find(".hotspot-title").css("visibility","hidden"),e.find(".hotspot-title").css("opacity","0"),e.find(".annotation").css("border-radius","100px"))})},t.prototype.add_annotations=function(t){var e;this.panoid=t;try{for(this.length=n.house[t][ANNOTATIONS].length,e=0;e<this.length;){if(this.destroy)return void this.remove_annotations();this.add_annotation(e),e++}}catch(o){return void(this.length=0)}},t.prototype.remove_annotations=function(){var t;for(t=0;t<this.length;)$("#annotation_"+t).remove(),t++},t.prototype.destroy_annotation=function(){return this.destroy=!0,this.remove_annotations()},t.prototype.update=function(){var e,o,i,a,r,s,l,h;for(a=0,r=this.panoid;a<this.length;)o="#annotation_"+a,t=$(o),e=n.house[r][ANNOTATIONS][a][LON],l=THREE.Math.degToRad(e),h=new THREE.Vector3(30*Math.cos(l),n.house[r][ANNOTATIONS][a][LAT],30*Math.sin(l)),h.x+=13*Math.cos(l),h.z+=13*Math.sin(l),h=h.project(n.camera),i=$("#"+DirectPano.pano_div_id),s={x:(h.x+1)/2*i.outerWidth(),y:-(h.y-1)/2*i.outerHeight()},t&&(h.x>1||h.x<-1||h.y>1||h.y<-1||h.z>1||h.z<-1?"none"!==t.css("display")&&(t.removeAttr("style"),t.css("display","none")):(t.css("display","inline"),t.css("left","-10px"),t.css("top","0px"),t.css("transform","translate3d("+s.x+"px,"+s.y+"px,0px)"),t.css("position","absolute"),t.css({"font-family":"'Helvetica Neue', Helvetica, Arial, sans-serif"}),t.css("font-size","16px"))),a++},t}(),n.annotation=e,t.exports=n}).call(this)},function(t,e,o){(function(){var e,i;i=o(5),e=function(){function t(){this.panoid=void 0,this.destroy=!1}return t.prototype.load_texture=function(){var t,e,o;return o=new THREE.Texture(window.texture_placeholder),e=new THREE.MeshBasicMaterial({map:o,overdraw:0,side:THREE.DoubleSide,depthTest:!1,depthWrite:!0,opacity:1,transparent:!0}),t=new Image,t.onload=function(){return t.onload=null,o.image=this,o.needsUpdate=!0},t.src="../test/images/logo.png",e},t.prototype.add_hotspot=function(e,o,n){var a,r,s,l,h,p,c,d;r=new THREE.PlaneBufferGeometry(10,10,10),s=this.load_texture(),t=new THREE.Mesh(r,s),h=THREE.Math.degToRad(e),t.position.x=60*Math.cos(h),t.position.y=-50,t.position.z=60*Math.sin(h),t.renderOrder=1,d=new THREE.Vector3(-t.position.x,400,-t.position.z),t.lookAt(d),r=new THREE.PlaneBufferGeometry(1,1,1),l=this.panoid,c="",void 0!==i.house[l][HOTSPOTS][o][TEXT]&&(c=i.house[l][HOTSPOTS][o][TEXT]),t.panoid=i.house[l][HOTSPOTS][o][TO_ID],t.deg_angle=e,a=$("#"+DirectPano.pano_div_id),p=$("<div></div>",{id:"hotspot_"+i.house[l][HOTSPOTS][o][TO_ID]}),p.html(c),$("#"+DirectPano.pano_div_id).append(p),t.hotspot_id=o,t.name="hotspot",i.scene.add(t),n.resolve()},t.prototype.add_hotspots=function(t){var e,o,n;for(this.panoid=t,n=i.house[t][HOTSPOTS].length,e=[],o=0;n>o;)e[o]=$.Deferred(),o++;for(o=0;n>o;){if(this.destroy)return void this.remove_hotspots();this.add_hotspot(i.house[t][HOTSPOTS][o][ANGLE],o,e[o]),o++}return $.when.apply($,e).done(function(){}).promise()},t.prototype.remove_hotspots=function(){var t,e,o,n;for(e=i.scene.children.length,n=0,t=0;e>t;)o=i.scene.children[n],"hotspot"===o.name?(o.geometry.dispose(),o.material.dispose(),i.scene.remove(o),$("#hotspot_"+o.panoid).remove()):n+=1,t++},t.prototype.front_nearest_hotspot=function(t){var e,o,n,a,r,s,l;for(s=i.house[t][HOTSPOTS].length,r=-1,a=void 0,e=!1,o=0;s>o;)l=i.house[t][HOTSPOTS][o][ANGLE],n=(i.Config.lon+360)%360,0>l&&(l+=360),(n>=45&&315>=n&&(n+45)%360>=l&&l>=(n-45+360)%360||45>=n&&l>=0&&n+45>=l||45>=n&&l>=(n-45+360)%360&&360>=l||n>=315&&l>=n-45&&360>=l||n>=315&&l>=0&&(n+45)%360>=l)&&(e===!1||Math.abs(l-n)<Math.abs(a-n))&&(a=l,r=o,e=!0),o++;return r},t.prototype.back_nearest_hotspot=function(t){var e,o,n,a,r,s,l;for(s=i.house[t][HOTSPOTS].length,r=-1,a=void 0,e=!1,o=0;s>o;)l=i.house[t][HOTSPOTS][o][ANGLE],n=(i.Config.lon+360+180)%360,0>l&&(l+=360),(n>=45&&315>=n&&(n+45)%360>=l&&l>=(n-45+360)%360||45>=n&&l>=0&&n+45>=l||45>=n&&l>=(n-45+360)%360&&360>=l||n>=315&&l>=n-45&&360>=l||n>=315&&l>=0&&(n+45)%360>=l)&&(e===!1||Math.abs(l-n)<Math.abs(a-n))&&(a=l,r=o,e=!0),o++;return r},t.prototype.destroy_hotspot=function(){return this.destroy=!0,this.remove_hotspots()},t.prototype.update=function(){var t,e,o,n,a,r,s,l;for(o=i.scene.children.length,e=0;o>e;)n=i.scene.children[e],"hotspot"===n.name&&(s=$("#hotspot_"+n.panoid),l=n.position.clone(),r=THREE.Math.degToRad(n.deg_angle+5),l.x+=13*Math.cos(r),l.z+=13*Math.sin(r),l=l.project(i.camera),t=$("#"+DirectPano.pano_div_id),a={x:(l.x+1)/2*t.outerWidth(),y:-(l.y-1)/2*t.outerHeight()},s&&(l.x>1||l.x<-1||l.y>1||l.y<-1||l.z>1||l.z<-1?"none"!==s.css("display")&&(s.removeAttr("style"),s.css({display:"none"})):s.css({display:"block",left:"-10px",top:"0px",transform:"translate3d("+a.x+"px,"+a.y+"px,0px)","text-align":"left",color:"Yellow",position:"absolute","margin-left":"-20px"}))),e++},t}(),i.hotspot=e,t.exports=i}).call(this)},function(t,e,o){(function(){var e,i,n,a,r;a=o(6),n=[{position:[-75,75,0]},{position:[75,75,0]},{position:[-75,-75,0]},{position:[75,-75,0]}],i=150,r=[{position:[-1*i,0,0],rotation:[0,Math.PI/2,0]},{position:[i,0,0],rotation:[0,-Math.PI/2,0]},{position:[0,i,0],rotation:[Math.PI/2,0,Math.PI]},{position:[0,-1*i,0],rotation:[-Math.PI/2,0,Math.PI]},{position:[0,0,i],rotation:[0,Math.PI,0]},{position:[0,0,-1*i],rotation:[0,0,0]}],e=function(){function t(t,e){this.pano_id=t,this.is_blur=e,this.name="panorama",this.destroy=!1}return t.prototype.create_pano=function(t,e){var o,i,s,l,h,p,c,d;for(this.mesh=new THREE.Object3D,o=[],s=0;24>s;)o[s]=$.Deferred(),s++;for(s=0;6>s;){for(l=0,d=new THREE.Object3D,a.clear_images[this.pano_id][s]={};4>l;)p=t,console.log(p),p=p.replace(/%s/g,a.Config.img_name[s]),p=p.replace(/%v/g,l%2),p=p.replace(/%h/g,parseInt(l/2)),h=this.load_texture(p,s,l,o[4*s+l]),i=a.Config.webgl?new THREE.PlaneBufferGeometry(150,150,7,7):new THREE.PlaneGeometry(150,150,20,20),c=new THREE.Mesh(i,h),c.material.transparent=!0,c.material.opacity=e,c.position.x=n[l].position[0],c.position.y=n[l].position[1],c.position.z=n[l].position[2],d.add(c),l++;d.rotation.x=r[s].rotation[0],d.rotation.y=r[s].rotation[1],d.rotation.z=r[s].rotation[2],d.updateMatrix(),d.position.x=r[s].position[0],d.position.y=r[s].position[1],d.position.z=r[s].position[2],d.updateMatrix(),this.mesh.add(d),s++}return a.scene.add(this.mesh),$.when.apply($,o).done(function(){}).promise()},t.prototype.destroy_pano=function(){var t,e,o;for(this.destroy=!0,a.scene.remove(this.mesh),t=0,o=[];6>t;){for(e=0;4>e;)this.mesh.children[t].children[e].material.map.dispose(),this.mesh.children[t].children[e].material.dispose(),this.mesh.children[t].children[e].geometry.dispose(),this.mesh.children[t].children[e]=null,e++;this.mesh.children[t]=null,o.push(t++)}return o},t.prototype.load_texture=function(t,e,o,i){var n,r,s,l;return l=new THREE.Texture(a.texture_placeholder),r=new THREE.MeshBasicMaterial({map:l,overdraw:0,side:THREE.DoubleSide,blending:THREE.AdditiveBlending,depthTest:!1}),s=this.pano_id,n=new Image,n.onload=function(){n.onload=null,l.image=this,l.needsUpdate=!0,i.resolve(),a.clear_images[s][e][o]=n},n.src=t,r},t.prototype.get_texture=function(t,e,o,i,n){var r,s,l;return r=!1,l=new THREE.Texture(a.texture_placeholder),t=this.pano_id,a.clear_images[t][i][n]?(r=!0,l.image=a.clear_images[t][i][n],l.needsUpdate=!0,o.resolve(),l):this.is_blur===!0&&a.blur_images[t]&&a.blur_images[t][i][n]?(r=!0,l.image=a.blur_images[t][i][n],l.needsUpdate=!0,o.resolve(),l):(s=new Image,s.onload=function(){l.image=this,l.needsUpdate=!0,o.resolve()},s.src=e,l)},t}(),a.Pano=e,t.exports=a}).call(this)},function(t,e,o){(function(){var e,i,n,a,r;a=o(7),r=void 0,n=void 0,i=!1,e=function(){function t(){this.destroy=!1,this.animate()}return t.prototype.animate=function(){var t;this.destroy||(requestAnimationFrame(this.animate.bind(this)),this.update(),a.Hotspot.update(),a.Annotation.update(),void 0!==a.Config.target_lon&&void 0!==a.Config.current_lon&&Math.abs(a.Config.target_lon-a.Config.current_lon)>.1&&(a.Transition.moving===!0?(void 0===a.Config.target_lon,a.Config.current_lon=void 0):(a.Config.current_lon=a.Config.current_lon+.15*(a.Config.target_lon-a.Config.current_lon),a.Config.lon=(a.Config.current_lon+360)%360)),void 0!==a.Config.target_lat&&void 0!==a.Config.current_lat&&Math.abs(a.Config.target_lat-a.Config.current_lat)>.1&&(a.Transition.moving===!0?(a.Config.target_lat=void 0,a.Config.current_lat=void 0):(a.Config.current_lat=a.Config.current_lat+.15*(a.Config.target_lat-a.Config.current_lat),a.Config.lat=a.Config.current_lat)),i===!0&&(a.Config.isUserInteracting===!0?i=!1:(t=Date.now()-r,1e3>t?a.Config.lat=n-n*t/1e3:(i=!1,a.Config.lat=0))))},t.prototype.update=function(){var t,e,o;a.Config.isUserInteracting===!1&&a.Config.autoplay===!0&&a.Transition.moving===!1?a.Config.lon+=.2:a.Config.isUserInteracting===!1&&(t=Date.now()-a.Config.stop_time,t>2e3&&(a.Config.autoplay=!0,i=!0,r=Date.now(),n=a.Config.lat)),a.Config.lon=(a.Config.lon+360)%360,a.Config.lat=Math.max(-35,Math.min(35,a.Config.lat)),e=THREE.Math.degToRad(90-a.Config.lat),o=THREE.Math.degToRad(a.Config.lon),a.camera.target.x=500*Math.sin(e)*Math.cos(o),a.camera.target.y=500*Math.cos(e),a.camera.target.z=500*Math.sin(e)*Math.sin(o),a.camera.lookAt(a.camera.target),a.renderer.render(a.scene,a.camera)},t}(),a.animation=e,t.exports=a}).call(this)},function(t,e){(function(){var e,o,i,n,a,r,s,l,h,p,c,d,u,f,g,_;f={},n=void 0,g=void 0,u=void 0,_=void 0,d=new THREE.Raycaster,i={},a={},o=void 0,c=!1,e={img_name:["mobile_r","mobile_l","mobile_u","mobile_d","mobile_f","mobile_b"],isUserInteracting:!1,lon:0,lat:0,stop_time:void 0,autoplay:!0,webgl:!0,current_lon:void 0,target_lon:void 0,current_lat:void 0,target_lat:void 0},h=function(){var t,e;t=$("#"+DirectPano.pano_div_id),t.width(window.innerWidth+"px").height(window.innerHeight+"px"),u.setSize(t.outerWidth(),t.outerHeight()),e=$("#"+DirectPano.image_div_id),e.css({visibility:"hidden"}),$("#panos-list").css("max-height",Math.min(400,window.innerHeight)+"px"),n.aspect=t.outerWidth()/t.outerHeight(),n.updateProjectionMatrix(),c=!0},l=function(){var t,e;t=$("#"+DirectPano.pano_div_id),t.width(DirectPano.initial_width+"px").height(DirectPano.initial_height+"px"),u.setSize(t.outerWidth(),t.outerHeight()),e=$("#"+DirectPano.image_div_id),e.css({visibility:"visible"}),$("#panos-list").css("max-height",Math.min(400,DirectPano.initial_height)+"px"),n.aspect=t.outerWidth()/t.outerHeight(),n.updateProjectionMatrix(),c=!1},s=function(){var t,o;try{return t=$("<canvas/>"),!(!window.WebGLRenderingContext||!t[0].getContext("webgl")&&!t[0].getContext("experimental-webgl"))}catch(i){return o=i,e.webgl=!1,!1}},p=function(){var t;t=$("#"+DirectPano.pano_div_id),t.width(Math.min(DirectPano.initial_width,window.innerWidth)+"px").height(Math.min(DirectPano.initial_height,window.innerHeight)+"px"),$("#panos-list").css("max-height",Math.min(400,DirectPano.initial_height)+"px"),g=new THREE.Scene,_=$("<canvas/>").width(128).height(128),u=s()?new THREE.WebGLRenderer:new THREE.CanvasRenderer,u.setPixelRatio(window.devicePixelRatio),t.append(u.domElement),u.setSize(t.outerWidth(),t.outerHeight()),n=new THREE.PerspectiveCamera(65,t.outerWidth()/t.outerHeight(),1,1100),n.target=new THREE.Vector3(0,0,0),$("#"+DirectPano.image_div_id).bind("touchstart click",function(){h()})},r=function(t){var o,n,r,s,l;for(f.Hotspot=void 0,o=0,r=a.length;r>o;o++)l=a[o],a[l]=null;for(n=0,s=i.length;s>n;n++)l=i[n],i[l]=null;a={},i={},e.lon=0,e.lat=0,e.stop_time=void 0,e.autoplay=!0},$(window).resize(function(){var t;t=$("#"+DirectPano.pano_div_id),c===!1?($("#panos-list").css("max-height",Math.min(400,DirectPano.initial_height)+"px"),t.width(Math.min(DirectPano.initial_width,window.innerWidth)+"px").height(Math.min(DirectPano.initial_height,window.innerHeight)+"px")):($("#panos-list").css("max-height",Math.min(400,window.innerHeight)+"px"),t.width(window.innerWidth+"px").height(window.innerHeight+"px")),u.setSize(t.outerWidth(),t.outerHeight()),n.aspect=t.outerWidth()/t.outerHeight(),n.updateProjectionMatrix()}),p(),f.destroy=r,f.Config=e,f.camera=n,f.scene=g,f.renderer=u,f.blur_images=i,f.clear_images=a,f.texture_placeholder=_,f.raycaster=d,f.escape_fullscreen=l,t.exports=f}).call(this)}]);
